<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>diff - Ruby/GSL (v1.16.0.2)</title>

<link href="../fonts.css" rel="stylesheet">
<link href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/navigation.js"></script>
<script src="../js/search_index.js"></script>
<script src="../js/search.js"></script>
<script src="../js/searcher.js"></script>
<script src="../js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-Numerical+Differentiation">Numerical Differentiation</a>
    <li><a href="#label-+Deriv+methods+%28for+GSL+1.4.90+or+later%29"><a href="index.html"name="1"></a> Deriv methods (for GSL 1.4.90 or later)</a>
    <li><a href="#label-+Diff+Methods+%28obsolete%29"><a href="index.html"name="2"></a> Diff Methods (obsolete)</a>
    <li><a href="#label-+Example"><a href="index.html"name="3"></a> Example</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../rdoc/alf_rdoc.html">alf</a>
  
    <li><a href="../rdoc/blas_rdoc.html">blas</a>
  
    <li><a href="../rdoc/bspline_rdoc.html">bspline</a>
  
    <li><a href="../rdoc/changes_rdoc.html">changes</a>
  
    <li><a href="../rdoc/cheb_rdoc.html">cheb</a>
  
    <li><a href="../rdoc/cholesky_complex_rdoc.html">cholesky_complex</a>
  
    <li><a href="../rdoc/combi_rdoc.html">combi</a>
  
    <li><a href="../rdoc/complex_rdoc.html">complex</a>
  
    <li><a href="../rdoc/const_rdoc.html">const</a>
  
    <li><a href="../rdoc/dht_rdoc.html">dht</a>
  
    <li><a href="../rdoc/diff_rdoc.html">diff</a>
  
    <li><a href="../rdoc/ehandling_rdoc.html">ehandling</a>
  
    <li><a href="../rdoc/eigen_rdoc.html">eigen</a>
  
    <li><a href="../rdoc/fft_rdoc.html">fft</a>
  
    <li><a href="../rdoc/fit_rdoc.html">fit</a>
  
    <li><a href="../rdoc/function_rdoc.html">function</a>
  
    <li><a href="../rdoc/graph_rdoc.html">graph</a>
  
    <li><a href="../rdoc/hist_rdoc.html">hist</a>
  
    <li><a href="../rdoc/hist2d_rdoc.html">hist2d</a>
  
    <li><a href="../rdoc/hist3d_rdoc.html">hist3d</a>
  
    <li><a href="../rdoc/index_rdoc.html">index</a>
  
    <li><a href="../rdoc/integration_rdoc.html">integration</a>
  
    <li><a href="../rdoc/interp_rdoc.html">interp</a>
  
    <li><a href="../rdoc/intro_rdoc.html">intro</a>
  
    <li><a href="../rdoc/linalg_rdoc.html">linalg</a>
  
    <li><a href="../rdoc/linalg_complex_rdoc.html">linalg_complex</a>
  
    <li><a href="../rdoc/math_rdoc.html">math</a>
  
    <li><a href="../rdoc/matrix_rdoc.html">matrix</a>
  
    <li><a href="../rdoc/min_rdoc.html">min</a>
  
    <li><a href="../rdoc/monte_rdoc.html">monte</a>
  
    <li><a href="../rdoc/multimin_rdoc.html">multimin</a>
  
    <li><a href="../rdoc/multiroot_rdoc.html">multiroot</a>
  
    <li><a href="../rdoc/narray_rdoc.html">narray</a>
  
    <li><a href="../rdoc/ndlinear_rdoc.html">ndlinear</a>
  
    <li><a href="../rdoc/nonlinearfit_rdoc.html">nonlinearfit</a>
  
    <li><a href="../rdoc/ntuple_rdoc.html">ntuple</a>
  
    <li><a href="../rdoc/odeiv_rdoc.html">odeiv</a>
  
    <li><a href="../rdoc/perm_rdoc.html">perm</a>
  
    <li><a href="../rdoc/poly_rdoc.html">poly</a>
  
    <li><a href="../rdoc/qrng_rdoc.html">qrng</a>
  
    <li><a href="../rdoc/randist_rdoc.html">randist</a>
  
    <li><a href="../rdoc/ref_rdoc.html">ref</a>
  
    <li><a href="../rdoc/rng_rdoc.html">rng</a>
  
    <li><a href="../rdoc/roots_rdoc.html">roots</a>
  
    <li><a href="../rdoc/sf_rdoc.html">sf</a>
  
    <li><a href="../rdoc/siman_rdoc.html">siman</a>
  
    <li><a href="../rdoc/sort_rdoc.html">sort</a>
  
    <li><a href="../rdoc/start_rdoc.html">start</a>
  
    <li><a href="../rdoc/stats_rdoc.html">stats</a>
  
    <li><a href="../rdoc/sum_rdoc.html">sum</a>
  
    <li><a href="../rdoc/tensor_rdoc.html">tensor</a>
  
    <li><a href="../rdoc/tut_rdoc.html">tut</a>
  
    <li><a href="../rdoc/use_rdoc.html">use</a>
  
    <li><a href="../rdoc/vector_rdoc.html">vector</a>
  
    <li><a href="../rdoc/vector_complex_rdoc.html">vector_complex</a>
  
    <li><a href="../rdoc/wavelet_rdoc.html">wavelet</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page rdoc/diff.rdoc">

<h1 id="label-Numerical+Differentiation">Numerical Differentiation<span><a href="#label-Numerical+Differentiation">&para;</a> <a href="#documentation">&uarr;</a></span></h1>

<p>The functions described in this chapter compute numerical derivatives by
finite differencing. An adaptive algorithm is used to find the best choice
of finite difference and to estimate the error in the derivative.</p>

<p>Contentes:</p>
<ol><li>
<p><a href="diff_rdoc.html#1">Deriv methods</a></p>
</li><li>
<p><a href="diff_rdoc.html#2">Diff methods</a></p>
</li></ol>

<h2 id="label-+Deriv+methods+%28for+GSL+1.4.90+or+later%29"><a href="../index.html"name="1"></a> Deriv methods (for GSL 1.4.90 or later)<span><a href="#label-+Deriv+methods+%28for+GSL+1.4.90+or+later%29">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p>Numerical derivatives should now be calculated using the
<code>GSL::Deriv.forward, GSL::Deriv.central</code> and
<code>GSL::Deriv.backward</code> methods, which accept a step-size argument
in addition to the position x.  The original <code>GSL::Diff</code> methods
(without the step-size) are deprecated.</p>
<hr>
<ul><li>
<p>GSL::Deriv.central(f, x, h = 1e-8)</p>
</li><li>
<p>GSL::Function#deriv_central(x, h = 1e-8)</p>

<p>These methods compute the numerical derivative of the function
<code>f</code> at the point <code>x</code> using an adaptive central
difference algorithm with a step-size of <code>h</code>. If a scalar
<code>x</code> is given, the derivative and an estimate of its absolute
error are returned as an array, [<code>result, abserr, status</code>]. If a
vector/matrix/array <code>x</code> is given, an array of two elements are
returned, [<code>result, abserr</code>], here each them is also a
vector/matrix/array of the same dimension of <code>x</code>.</p>

<p>The initial value of <code>h</code> is used to estimate an optimal
step-size, based on the scaling of the truncation error and round-off error
in the derivative calculation. The derivative is computed using a 5-point
rule for equally spaced abscissae at x-h, x-h/2, x, x+h/2, x, with an error
estimate taken from the difference between the 5-point rule and the
corresponding 3-point rule x-h, x, x+h. Note that the value of the function
at x does not contribute to the derivative calculation, so only 4-points
are actually used.</p>
</li></ul>
<hr>
<ul><li>
<p>GSL::Deriv.forward(f, x, h = 1e-8)</p>
</li><li>
<p>GSL::Function#deriv_forward(x, h = 1e-8)</p>

<p>These methods compute the numerical derivative of the function
<code>f</code> at the point <code>x</code> using an adaptive forward
difference algorithm with a step-size of <code>h</code>. The function is
evaluated only at points greater than <code>x</code>, and never at
<code>x</code> itself. The derivative and an estimate of its absolute error
are returned as an array, [<code>result, abserr</code>]. These methods
should be used if f(x) has a discontinuity at <code>x</code>, or is
undefined for values less than <code>x</code>.</p>

<p>The initial value of <code>h</code> is used to estimate an optimal
step-size, based on the scaling of the truncation error and round-off error
in the derivative calculation. The derivative at x is computed using an
“open” 4-point rule for equally spaced abscissae at x+h/4, x+h/2, x+3h/4,
x+h, with an error estimate taken from the difference between the 4-point
rule and the corresponding 2-point rule x+h/2, x+h.</p>
</li></ul>
<hr>
<ul><li>
<p>GSL::Deriv.backward(f, x, h)</p>
</li><li>
<p>GSL::Function#deriv_backward(x, h)</p>

<p>These methods compute the numerical derivative of the function
<code>f</code> at the point <code>x</code> using an adaptive backward
difference algorithm with a step-size of <code>h</code>. The function is
evaluated only at points less than <code>x</code>, and never at
<code>x</code> itself. The derivative and an estimate of its absolute error
are returned as an array, [<code>result, abserr</code>]. This function
should be used if f(x) has a discontinuity at <code>x</code>, or is
undefined for values greater than <code>x</code>.</p>

<p>These methods are equivalent to calling the method <code>forward</code>
with a negative step-size.</p>
</li></ul>

<h2 id="label-+Diff+Methods+%28obsolete%29"><a href="../index.html"name="2"></a> Diff Methods (obsolete)<span><a href="#label-+Diff+Methods+%28obsolete%29">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<hr>
<ul><li>
<p>GSL::Diff.central(f, x)</p>
</li><li>
<p>GSL::Function#diff_central(x)</p>

<p>These compute the numerical derivative of the function <code>f</code> ( <a
href="function_rdoc.html">GSL::Function</a> object) at the point
<code>x</code> using an adaptive central difference algorithm. The result
is returned as an array which contains the derivative and an estimate of
its absolute error.</p>
</li></ul>
<hr>
<ul><li>
<p>GSL::Diff.forward(f, x)</p>
</li><li>
<p>GSL::Function#diff_forward(x)</p>

<p>These compute the numerical derivative of the function at the point x using
an adaptive forward difference algorithm.</p>
</li></ul>
<hr>
<ul><li>
<p>GSL::Diff.backward(f, x)</p>
</li><li>
<p>GSL::Function#diff_backward(x)</p>

<p>These compute the numerical derivative of the function at the point x using
an adaptive backward difference algorithm.</p>
</li></ul>

<h2 id="label-+Example"><a href="../index.html"name="3"></a> Example<span><a href="#label-+Example">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-comment">#!/usr/bin/env ruby</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&quot;gsl&quot;</span>

<span class="ruby-identifier">f</span> = <span class="ruby-constant">GSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Function</span>.<span class="ruby-identifier">alloc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">pow</span>(<span class="ruby-identifier">x</span>, <span class="ruby-value">1.5</span>)
}

<span class="ruby-identifier">printf</span> (<span class="ruby-string">&quot;f(x) = x^(3/2)\n&quot;</span>);

<span class="ruby-identifier">x</span> = <span class="ruby-value">2.0</span>
<span class="ruby-identifier">h</span> = <span class="ruby-value">1e-8</span>
<span class="ruby-identifier">result</span>, <span class="ruby-identifier">abserr</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">deriv_central</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">h</span>)
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;x = 2.0\n&quot;</span>);
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;f&#39;(x) = %.10f +/- %.10f\n&quot;</span>, <span class="ruby-identifier">result</span>, <span class="ruby-identifier">abserr</span>);
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;exact = %.10f\n\n&quot;</span>, <span class="ruby-value">1.5</span> <span class="ruby-operator">*</span> <span class="ruby-constant">Math</span><span class="ruby-operator">::</span><span class="ruby-identifier">sqrt</span>(<span class="ruby-value">2.0</span>));

<span class="ruby-identifier">x</span> = <span class="ruby-value">0.0</span>
<span class="ruby-identifier">result</span>, <span class="ruby-identifier">abserr</span> = <span class="ruby-constant">Deriv</span>.<span class="ruby-identifier">forward</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">x</span>, <span class="ruby-identifier">h</span>) <span class="ruby-comment"># equivalent to f.deriv_forward(x, h)</span>
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;x = 0.0\n&quot;</span>);
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;f&#39;(x) = %.10f +/- %.10f\n&quot;</span>, <span class="ruby-identifier">result</span>, <span class="ruby-identifier">abserr</span>);
<span class="ruby-identifier">printf</span>(<span class="ruby-string">&quot;exact = %.10f\n&quot;</span>, <span class="ruby-value">0.0</span>);
</pre>

<p>The results are</p>

<pre>f(x) = x^(3/2)
x = 2.0
f&#39;(x) = 2.1213203120 +/- 0.0000004064
exact = 2.1213203436

x = 0.0
f&#39;(x) = 0.0000000160 +/- 0.0000000339
exact = 0.0000000000</pre>

<p><a href="interp_rdoc.html">prev</a> <a href="cheb_rdoc.html">next</a></p>

<p><a href="ref_rdoc.html">Reference index</a> <a href="../index.html">top</a></p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

